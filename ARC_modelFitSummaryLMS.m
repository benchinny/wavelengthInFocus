%%

RMSvals = [0.0891 0.11  0.223; ...
           0.0648 0.143 0.233; ...
           0.157  0.112 0.385; ...
           0.164  0.165 0.432; ...
           0.0902 0.136 0.219; ...
           0.102  0.195 0.259; ...
           0.144  0.111 0.295; ...
           0.105  0.182 0.106];

figure;
set(gcf,'Position',[314 423 915 420]);
hold on;
for i = 1:size(RMSvals,1)
    bar((i-1)*3+1,RMSvals(i,1),'FaceColor','b','LineWidth',1);
    bar((i-1)*3+2,RMSvals(i,3),'FaceColor','w','LineWidth',1);
end
set(gca,'FontSize',15);
set(gca,'XTick',0.5+[1 4 7 10 13 16 19 22]);
set(gca,'XTickLabel',{'S1' 'S3' 'S5' 'S10' 'S16' 'S17' 'S18' 'S20'});
xlabel('Subject');
ylabel('Model RMSE');
legend('(L+M)-S','Luminance');

%% FITTED WEIGHTS FOR LUMINANCE AND BLUE-YELLOW OPPONENT MODELS

weightsLMS = [0.5525 0.2975 -1; ...
              0.4725 0.5775 -1; ...
              1.1562 0.09375 -0.5; ...
              1.1475 0.2025 -1; ...
              0.2625 0.4875 -1; ...
              0.325 0.675 -1; ...
              1.35 0 -1; ...
              1.08 0.27 -0.25 ...
              ];

weightsLM = [0.825 0.175 0; ...
             0.85 0.15 0; ...
             0.85 0.15 0; ...
             0.85 0.15 0; ...
             0.25 0.75 0; ...
             0.825 0.175 0; ...
             0.85 0.15 0; ...
             0.75 0.25 0];

figure;
hold on;
bar(1:3:22,weightsLMS(:,1)./(weightsLMS(:,2)+weightsLMS(:,1)),0.33,'FaceColor','w','LineWidth',1);
bar(2:3:23,weightsLMS(:,3)./(weightsLMS(:,2)+weightsLMS(:,1)),0.33,'FaceColor',[0 0.45 0.74],'LineWidth',1);
set(gca,'FontSize',20);
ylabel('Weight');
axis square;
set(gca,'XTick',1.5:3:22.5);
set(gca,'XTickLabel',{'S1' 'S2' 'S3' 'S4' 'S5' 'S6' 'S7' 'S8'});
legend('w_{L}/w_{M}','w_{S}/(w_{L} + w_{M})','Location','NorthEastOutside');
